import { Component, Input } from '@angular/core';
import { DatePipe } from '@angular/common';
import { PoInfoOrientation } from '@po-ui/ng-components';
export class PoPageJobSchedulerSummaryComponent {
    constructor(datePipe) {
        this.datePipe = datePipe;
        this.literals = {};
        this.parameters = [];
        this.value = {};
        this.noParameters = true;
        this.executionValue = '';
        this.firstExecutionValue = '';
        this.infoOrientation = PoInfoOrientation.Horizontal;
        this.periodicityValue = '';
        this.frequencyValue = '';
        this.rangeLimitHour = '';
        this.rangeLimitDay = '';
        this.recurrentValue = '';
    }
    ngOnInit() {
        const { periodicity, hour, dayOfMonth, daysOfWeek, recurrent, firstExecution, firstExecutionHour, frequency, rangeLimitHour, rangeLimitDay } = this.value;
        this.periodicityValue = this.getPeriodicityLabel(periodicity);
        if (frequency) {
            this.frequencyValue = this.getFrequencyValue(frequency, periodicity);
        }
        this.executionValue = this.getExecutionValue(periodicity, hour, daysOfWeek, dayOfMonth, rangeLimitHour, rangeLimitDay);
        this.firstExecutionValue = this.getFirstExecutionLabel(firstExecution, firstExecutionHour);
        this.recurrentValue = this.getRecurrentValue(recurrent);
    }
    getFrequencyValue(frequency, periodicity) {
        return frequency['value'] && frequency['type'] && periodicity !== 'single'
            ? `${frequency['value']} - ${frequency['type']}`
            : '';
    }
    getExecutionValue(periodicity, hour, daysOfWeek, dayOfMonth, rangeLimitHour, rangeLimitDay) {
        switch (periodicity) {
            case 'daily':
                return this.getHourLabel(hour, rangeLimitHour);
            case 'monthly':
                return this.getMonthlyLabelExecution(dayOfMonth, hour, rangeLimitHour, rangeLimitDay);
            case 'weekly':
                return this.getWeeklyLabelExecution(daysOfWeek, hour, rangeLimitHour);
            default:
                return this.literals.notReported;
        }
    }
    getFirstExecutionLabel(firstExecution, firstExecutionHour) {
        if (firstExecution) {
            const date = this.datePipe.transform(firstExecution, 'dd/MM/yyyy', '-0200');
            return `${date} ${this.getHourLabel(firstExecutionHour)}`;
        }
        else {
            return this.literals.notReported;
        }
    }
    getHourLabel(hour, rangeLimitHour) {
        return `${rangeLimitHour ? this.literals.from : this.literals.at} ${hour || '00:00'} ${rangeLimitHour ? this.literals.to + ' ' + rangeLimitHour : ''}`;
    }
    getMonthlyLabelExecution(dayOfMonth, hour, rangeLimitHour, rangeLimitDay) {
        const hourLabel = this.getHourLabel(hour, rangeLimitHour);
        return `${rangeLimitDay ? this.literals.from : ''} ${dayOfMonth} ${rangeLimitDay ? this.literals.to : ''} ${rangeLimitDay ? rangeLimitDay : ''} ${hourLabel}`;
    }
    getPeriodicityLabel(periodicity) {
        switch (periodicity) {
            case 'daily':
                return this.literals.daily;
            case 'monthly':
                return this.literals.monthly;
            case 'weekly':
                return this.literals.weekly;
            default:
                return this.literals.single;
        }
    }
    getRecurrentValue(recurrent) {
        return recurrent ? this.literals.yes : this.literals.no;
    }
    getSorterWeekDays() {
        return {
            'sunday': 0,
            'monday': 1,
            'tuesday': 2,
            'wednesday': 3,
            'thursday': 4,
            'friday': 5,
            'saturday': 6
        };
    }
    getTranslateWeekDay(day) {
        const days = {
            Sunday: this.literals.sunday,
            Monday: this.literals.monday,
            Tuesday: this.literals.tuesday,
            Wednesday: this.literals.wednesday,
            Thursday: this.literals.thursday,
            Friday: this.literals.friday,
            Saturday: this.literals.saturday
        };
        return days[day] || '';
    }
    getWeekDaysLabel(days = []) {
        const weekDaysSorted = this.sortWeekDays(days);
        return weekDaysSorted.map(day => this.getTranslateWeekDay(day)).join(', ');
    }
    getWeeklyLabelExecution(daysOfWeek, hour, rangeLimitHour) {
        if (daysOfWeek && Array.isArray(daysOfWeek)) {
            return `${this.getWeekDaysLabel(daysOfWeek)} ${this.getHourLabel(hour, rangeLimitHour)}`;
        }
        else {
            return this.literals.notReported;
        }
    }
    sortWeekDays(days = []) {
        const sorterWeekDays = this.getSorterWeekDays();
        return days.sort((a, b) => {
            const currDay = a.toLowerCase();
            const nextDay = b.toLowerCase();
            return sorterWeekDays[currDay] > sorterWeekDays[nextDay] ? 1 : -1;
        });
    }
}
PoPageJobSchedulerSummaryComponent.decorators = [
    { type: Component, args: [{
                selector: 'po-page-job-scheduler-summary',
                template: "<div class=\"po-md-12\">\r\n  <po-info\r\n    *ngIf=\"noParameters\"\r\n    [p-label]=\"literals.process\"\r\n    [p-orientation]=\"infoOrientation\"\r\n    [p-value]=\"value.processID\"\r\n  >\r\n  </po-info>\r\n\r\n  <po-info [p-label]=\"literals.periodicity\" [p-orientation]=\"infoOrientation\" [p-value]=\"periodicityValue\"> </po-info>\r\n\r\n  <po-info\r\n    *ngIf=\"frequencyValue !== ''\"\r\n    [p-label]=\"literals.frequency\"\r\n    [p-orientation]=\"infoOrientation\"\r\n    [p-value]=\"frequencyValue\"\r\n  >\r\n  </po-info>\r\n\r\n  <po-info\r\n    *ngIf=\"value.periodicity !== 'single'\"\r\n    [p-label]=\"literals.execution\"\r\n    [p-orientation]=\"infoOrientation\"\r\n    [p-value]=\"executionValue\"\r\n  >\r\n  </po-info>\r\n\r\n  <po-info [p-label]=\"literals.recurrent\" [p-orientation]=\"infoOrientation\" [p-value]=\"recurrentValue\"> </po-info>\r\n\r\n  <po-info [p-label]=\"literals.firstExecution\" [p-orientation]=\"infoOrientation\" [p-value]=\"firstExecutionValue\">\r\n  </po-info>\r\n</div>\r\n\r\n<po-widget *ngIf=\"parameters && parameters.length\" class=\"po-pt-1 po-pb-1 po-md-12\" [p-title]=\"literals.parameters\">\r\n  <po-dynamic-view [p-fields]=\"parameters\" [p-value]=\"value.executionParameter\"> </po-dynamic-view>\r\n</po-widget>\r\n"
            },] }
];
PoPageJobSchedulerSummaryComponent.ctorParameters = () => [
    { type: DatePipe }
];
PoPageJobSchedulerSummaryComponent.propDecorators = {
    literals: [{ type: Input, args: ['p-literals',] }],
    parameters: [{ type: Input, args: ['p-parameters',] }],
    value: [{ type: Input, args: ['p-value',] }],
    noParameters: [{ type: Input, args: ['p-no-parameters',] }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicG8tcGFnZS1qb2Itc2NoZWR1bGVyLXN1bW1hcnkuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvdGVtcGxhdGVzL3NyYy9saWIvY29tcG9uZW50cy9wby1wYWdlLWpvYi1zY2hlZHVsZXIvcG8tcGFnZS1qb2Itc2NoZWR1bGVyLXN1bW1hcnkvcG8tcGFnZS1qb2Itc2NoZWR1bGVyLXN1bW1hcnkuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFVLE1BQU0sZUFBZSxDQUFDO0FBQ3pELE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUUzQyxPQUFPLEVBQXNCLGlCQUFpQixFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFRN0UsTUFBTSxPQUFPLGtDQUFrQztJQWtCN0MsWUFBb0IsUUFBa0I7UUFBbEIsYUFBUSxHQUFSLFFBQVEsQ0FBVTtRQWpCakIsYUFBUSxHQUFRLEVBQUUsQ0FBQztRQUVqQixlQUFVLEdBQThCLEVBQUUsQ0FBQztRQUVoRCxVQUFLLEdBQWdDLEVBQUUsQ0FBQztRQUVoQyxpQkFBWSxHQUFZLElBQUksQ0FBQztRQUV2RCxtQkFBYyxHQUFHLEVBQUUsQ0FBQztRQUNwQix3QkFBbUIsR0FBRyxFQUFFLENBQUM7UUFDekIsb0JBQWUsR0FBRyxpQkFBaUIsQ0FBQyxVQUFVLENBQUM7UUFDL0MscUJBQWdCLEdBQUcsRUFBRSxDQUFDO1FBQ3RCLG1CQUFjLEdBQUcsRUFBRSxDQUFDO1FBQ3BCLG1CQUFjLEdBQUcsRUFBRSxDQUFDO1FBQ3BCLGtCQUFhLEdBQUcsRUFBRSxDQUFDO1FBQ25CLG1CQUFjLEdBQUcsRUFBRSxDQUFDO0lBRXFCLENBQUM7SUFFMUMsUUFBUTtRQUNOLE1BQU0sRUFDSixXQUFXLEVBQ1gsSUFBSSxFQUNKLFVBQVUsRUFDVixVQUFVLEVBQ1YsU0FBUyxF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QU8sSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQVMsRUFBRSxDQUFTLEVBQUUsRUFBRTtZQUN4QyxNQUFNLE9BQU8sR0FBRyxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7WUFDaEMsTUFBTSxPQUFPLEdBQUcsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBRWhDLE9BQU8sY0FBYyxDQUFDLE9BQU8sQ0FBQyxHQUFHLGNBQWMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNwRSxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7OztZQTFLRixTQUFTLFNBQUM7Z0JBQ1QsUUFBUSxFQUFFLCtCQUErQjtnQkFDekMsa3hDQUEyRDthQUM1RDs7O1lBVFEsUUFBUTs7O3VCQVdkLEtBQUssU0FBQyxZQUFZO3lCQUVsQixLQUFLLFNBQUMsY0FBYztvQkFFcEIsS0FBSyxTQUFDLFNBQVM7MkJBRWYsS0FBSyxTQUFDLGlCQUFpQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgSW5wdXQsIE9uSW5pdCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBEYXRlUGlwZSB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XHJcblxyXG5pbXBvcnQgeyBQb0R5bmFtaWNWaWV3RmllbGQsIFBvSW5mb09yaWVudGF0aW9uIH0gZnJvbSAnQHBvLXVpL25nLWNvbXBvbmVudHMnO1xyXG5cclxuaW1wb3J0IHsgUG9Kb2JTY2hlZHVsZXJJbnRlcm5hbCB9IGZyb20gJy4uL2ludGVyZmFjZXMvcG8tam9iLXNjaGVkdWxlci1pbnRlcm5hbC5pbnRlcmZhY2UnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdwby1wYWdlLWpvYi1zY2hlZHVsZXItc3VtbWFyeScsXHJcbiAgdGVtcGxhdGVVcmw6ICdwby1wYWdlLWpvYi1zY2hlZHVsZXItc3VtbWFyeS5jb21wb25lbnQuaHRtbCdcclxufSlcclxuZXhwb3J0IGNsYXNzIFBvUGFnZUpvYlNjaGVkdWxlclN1bW1hcnlDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xyXG4gIEBJbnB1dCgncC1saXRlcmFscycpIGxpdGVyYWxzID0gPGFueT57fTtcclxuXHJcbiAgQElucHV0KCdwLXBhcmFtZXRlcnMnKSBwYXJhbWV0ZXJzOiBBcnJheTxQb0R5bmFtaWNWaWV3RmllbGQ+ID0gW107XHJcblxyXG4gIEBJbnB1dCgncC12YWx1ZScpIHZhbHVlOiBQb0pvYlNjaGVkdWxlckludGVybmFsID0gPGFueT57fTtcclxuXHJcbiAgQElucHV0KCdwLW5vLXBhcmFtZXRlcnMnKSBub1BhcmFtZXRlcnM6IEJvb2xlYW4gPSB0cnVlO1xyXG5cclxuICBleGVjdXRpb25WYWx1ZSA9ICcnO1xyXG4gIGZpcnN0RXhlY3V0aW9uVmFsdWUgPSAnJztcclxuICBpbmZvT3JpZW50YXRpb24gPSBQb0luZm9PcmllbnRhdGlvbi5Ib3Jpem9udGFsO1xyXG4gIHBlcmlvZGljaXR5VmFsdWUgPSAnJztcclxuICBmcmVxdWVuY3lWYWx1ZSA9ICcnO1xyXG4gIHJhbmdlTGltaXRIb3VyID0gJyc7XHJcbiAgcmFuZ2VMaW1pdERheSA9ICcnO1xyXG4gIHJlY3VycmVudFZhbHVlID0gJyc7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgZGF0ZVBpcGU6IERhdGVQaXBlKSB7fVxyXG5cclxuICBuZ09uSW5pdCgpIHtcclxuICAgIGNvbnN0IHtcclxuICAgICAgcGVyaW9kaWNpdHksXHJcbiAgICAgIGhvdXIsXHJcbiAgICAgIGRheU9mTW9udGgsXHJcbiAgICAgIGRheXNPZldlZWssXHJcbiAgICAgIHJlY3VycmVudCxcclxuICAgICAgZmlyc3RFeGVjdXRpb24sXHJcbiAgICAgIGZpcnN0RXhlY3V0aW9uSG91cixcclxuICAgICAgZnJlcXVlbmN5LFxyXG4gICAgICByYW5nZUxpbWl0SG91cixcclxuICAgICAgcmFuZ2VMaW1pdERheVxyXG4gICAgfSA9IHRoaXMudmFsdWU7XHJcblxyXG4gICAgdGhpcy5wZXJpb2RpY2l0eVZhbHVlID0gdGhpcy5nZXRQZXJpb2RpY2l0eUxhYmVsKHBlcmlvZGljaXR5KTtcclxuICAgIGlmIChmcmVxdWVuY3kpIHtcclxuICAgICAgdGhpcy5mcmVxdWVuY3lWYWx1ZSA9IHRoaXMuZ2V0RnJlcXVlbmN5VmFsdWUoZnJlcXVlbmN5LCBwZXJpb2RpY2l0eSk7XHJcbiAgICB9XHJcbiAgICB0aGlzLmV4ZWN1dGlvblZhbHVlID0gdGhpcy5nZXRFeGVjdXRpb25WYWx1ZShcclxuICAgICAgcGVyaW9kaWNpdHksXHJcbiAgICAgIGhvdXIsXHJcbiAgICAgIGRheXNPZldlZWssXHJcbiAgICAgIGRheU9mTW9udGgsXHJcbiAgICAgIHJhbmdlTGltaXRIb3VyLFxyXG4gICAgICByYW5nZUxpbWl0RGF5XHJcbiAgICApO1xyXG4gICAgdGhpcy5maXJzdEV4ZWN1dGlvblZhbHVlID0gdGhpcy5nZXRGaXJzdEV4ZWN1dGlvbkxhYmVsKGZpcnN0RXhlY3V0aW9uLCBmaXJzdEV4ZWN1dGlvbkhvdXIpO1xyXG4gICAgdGhpcy5yZWN1cnJlbnRWYWx1ZSA9IHRoaXMuZ2V0UmVjdXJyZW50VmFsdWUocmVjdXJyZW50KTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0RnJlcXVlbmN5VmFsdWUoZnJlcXVlbmN5LCBwZXJpb2RpY2l0eSkge1xyXG4gICAgcmV0dXJuIGZyZXF1ZW5jeVsndmFsdWUnXSAmJiBmcmVxdWVuY3lbJ3R5cGUnXSAmJiBwZXJpb2RpY2l0eSAhPT0gJ3NpbmdsZSdcclxuICAgICAgPyBgJHtmcmVxdWVuY3lbJ3ZhbHVlJ119IC0gJHtmcmVxdWVuY3lbJ3R5cGUnXX1gXHJcbiAgICAgIDogJyc7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldEV4ZWN1dGlvblZhbHVlKFxyXG4gICAgcGVyaW9kaWNpdHk6IHN0cmluZyxcclxuICAgIGhvdXI/OiBzdHJpbmcsXHJcbiAgICBkYXlzT2ZXZWVrPzogQXJyYXk8c3RyaW5nPixcclxuICAgIGRheU9mTW9udGg/OiBudW1iZXIsXHJcbiAgICByYW5nZUxpbWl0SG91cj86IHN0cmluZyxcclxuICAgIHJhbmdlTGltaXREYXk/OiBudW1iZXJcclxuICApIHtcclxuICAgIHN3aXRjaCAocGVyaW9kaWNpdHkpIHtcclxuICAgICAgY2FzZSAnZGFpbHknOlxyXG4gICAgICAgIHJldHVybiB0aGlzLmdldEhvdXJMYWJlbChob3VyLCByYW5nZUxpbWl0SG91cik7XHJcbiAgICAgIGNhc2UgJ21vbnRobHknOlxyXG4gICAgICAgIHJldHVybiB0aGlzLmdldE1vbnRobHlMYWJlbEV4ZWN1dGlvbihkYXlPZk1vbnRoLCBob3VyLCByYW5nZUxpbWl0SG91ciwgcmFuZ2VMaW1pdERheSk7XHJcbiAgICAgIGNhc2UgJ3dlZWtseSc6XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0V2Vla2x5TGFiZWxFeGVjdXRpb24oZGF5c09mV2VlaywgaG91ciwgcmFuZ2VMaW1pdEhvdXIpO1xyXG4gICAgICBkZWZhdWx0OlxyXG4gICAgICAgIHJldHVybiB0aGlzLmxpdGVyYWxzLm5vdFJlcG9ydGVkO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXRGaXJzdEV4ZWN1dGlvbkxhYmVsKGZpcnN0RXhlY3V0aW9uOiBEYXRlLCBmaXJzdEV4ZWN1dGlvbkhvdXI/OiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgaWYgKGZpcnN0RXhlY3V0aW9uKSB7XHJcbiAgICAgIGNvbnN0IGRhdGUgPSB0aGlzLmRhdGVQaXBlLnRyYW5zZm9ybShmaXJzdEV4ZWN1dGlvbiwgJ2RkL01NL3l5eXknLCAnLTAyMDAnKTtcclxuXHJcbiAgICAgIHJldHVybiBgJHtkYXRlfSAke3RoaXMuZ2V0SG91ckxhYmVsKGZpcnN0RXhlY3V0aW9uSG91cil9YDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiB0aGlzLmxpdGVyYWxzLm5vdFJlcG9ydGVkO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXRIb3VyTGFiZWwoaG91cjogc3RyaW5nLCByYW5nZUxpbWl0SG91cj8pIHtcclxuICAgIHJldHVybiBgJHtyYW5nZUxpbWl0SG91ciA/IHRoaXMubGl0ZXJhbHMuZnJvbSA6IHRoaXMubGl0ZXJhbHMuYXR9ICR7aG91ciB8fCAnMDA6MDAnfSAke1xyXG4gICAgICByYW5nZUxpbWl0SG91ciA/IHRoaXMubGl0ZXJhbHMudG8gKyAnICcgKyByYW5nZUxpbWl0SG91ciA6ICcnXHJcbiAgICB9YDtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0TW9udGhseUxhYmVsRXhlY3V0aW9uKGRheU9mTW9udGg6IG51bWJlciwgaG91cjogc3RyaW5nLCByYW5nZUxpbWl0SG91cj86IHN0cmluZywgcmFuZ2VMaW1pdERheT86IG51bWJlcikge1xyXG4gICAgY29uc3QgaG91ckxhYmVsID0gdGhpcy5nZXRIb3VyTGFiZWwoaG91ciwgcmFuZ2VMaW1pdEhvdXIpO1xyXG5cclxuICAgIHJldHVybiBgJHtyYW5nZUxpbWl0RGF5ID8gdGhpcy5saXRlcmFscy5mcm9tIDogJyd9ICR7ZGF5T2ZNb250aH0gJHtyYW5nZUxpbWl0RGF5ID8gdGhpcy5saXRlcmFscy50byA6ICcnfSAke1xyXG4gICAgICByYW5nZUxpbWl0RGF5ID8gcmFuZ2VMaW1pdERheSA6ICcnXHJcbiAgICB9ICR7aG91ckxhYmVsfWA7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldFBlcmlvZGljaXR5TGFiZWwocGVyaW9kaWNpdHkpIHtcclxuICAgIHN3aXRjaCAocGVyaW9kaWNpdHkpIHtcclxuICAgICAgY2FzZSAnZGFpbHknOlxyXG4gICAgICAgIHJldHVybiB0aGlzLmxpdGVyYWxzLmRhaWx5O1xyXG4gICAgICBjYXNlICdtb250aGx5JzpcclxuICAgICAgICByZXR1cm4gdGhpcy5saXRlcmFscy5tb250aGx5O1xyXG4gICAgICBjYXNlICd3ZWVrbHknOlxyXG4gICAgICAgIHJldHVybiB0aGlzLmxpdGVyYWxzLndlZWtseTtcclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICByZXR1cm4gdGhpcy5saXRlcmFscy5zaW5nbGU7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldFJlY3VycmVudFZhbHVlKHJlY3VycmVudDogYm9vbGVhbik6IHN0cmluZyB7XHJcbiAgICByZXR1cm4gcmVjdXJyZW50ID8gdGhpcy5saXRlcmFscy55ZXMgOiB0aGlzLmxpdGVyYWxzLm5vO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXRTb3J0ZXJXZWVrRGF5cygpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICdzdW5kYXknOiAwLFxyXG4gICAgICAnbW9uZGF5JzogMSxcclxuICAgICAgJ3R1ZXNkYXknOiAyLFxyXG4gICAgICAnd2VkbmVzZGF5JzogMyxcclxuICAgICAgJ3RodXJzZGF5JzogNCxcclxuICAgICAgJ2ZyaWRheSc6IDUsXHJcbiAgICAgICdzYXR1cmRheSc6IDZcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldFRyYW5zbGF0ZVdlZWtEYXkoZGF5OiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgY29uc3QgZGF5cyA9IHtcclxuICAgICAgU3VuZGF5OiB0aGlzLmxpdGVyYWxzLnN1bmRheSxcclxuICAgICAgTW9uZGF5OiB0aGlzLmxpdGVyYWxzLm1vbmRheSxcclxuICAgICAgVHVlc2RheTogdGhpcy5saXRlcmFscy50dWVzZGF5LFxyXG4gICAgICBXZWRuZXNkYXk6IHRoaXMubGl0ZXJhbHMud2VkbmVzZGF5LFxyXG4gICAgICBUaHVyc2RheTogdGhpcy5saXRlcmFscy50aHVyc2RheSxcclxuICAgICAgRnJpZGF5OiB0aGlzLmxpdGVyYWxzLmZyaWRheSxcclxuICAgICAgU2F0dXJkYXk6IHRoaXMubGl0ZXJhbHMuc2F0dXJkYXlcclxuICAgIH07XHJcblxyXG4gICAgcmV0dXJuIGRheXNbZGF5XSB8fCAnJztcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0V2Vla0RheXNMYWJlbChkYXlzOiBBcnJheTxzdHJpbmc+ID0gW10pOiBzdHJpbmcge1xyXG4gICAgY29uc3Qgd2Vla0RheXNTb3J0ZWQgPSB0aGlzLnNvcnRXZWVrRGF5cyhkYXlzKTtcclxuXHJcbiAgICByZXR1cm4gd2Vla0RheXNTb3J0ZWQubWFwKGRheSA9PiB0aGlzLmdldFRyYW5zbGF0ZVdlZWtEYXkoZGF5KSkuam9pbignLCAnKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0V2Vla2x5TGFiZWxFeGVjdXRpb24oZGF5c09mV2VlazogQXJyYXk8c3RyaW5nPiwgaG91cjogc3RyaW5nLCByYW5nZUxpbWl0SG91cj86IHN0cmluZykge1xyXG4gICAgaWYgKGRheXNPZldlZWsgJiYgQXJyYXkuaXNBcnJheShkYXlzT2ZXZWVrKSkge1xyXG4gICAgICByZXR1cm4gYCR7dGhpcy5nZXRXZWVrRGF5c0xhYmVsKGRheXNPZldlZWspfSAke3RoaXMuZ2V0SG91ckxhYmVsKGhvdXIsIHJhbmdlTGltaXRIb3VyKX1gO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIHRoaXMubGl0ZXJhbHMubm90UmVwb3J0ZWQ7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHNvcnRXZWVrRGF5cyhkYXlzOiBBcnJheTxzdHJpbmc+ID0gW10pIHtcclxuICAgIGNvbnN0IHNvcnRlcldlZWtEYXlzID0gdGhpcy5nZXRTb3J0ZXJXZWVrRGF5cygpO1xyXG5cclxuICAgIHJldHVybiBkYXlzLnNvcnQoKGE6IHN0cmluZywgYjogc3RyaW5nKSA9PiB7XHJcbiAgICAgIGNvbnN0IGN1cnJEYXkgPSBhLnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgIGNvbnN0IG5leHREYXkgPSBiLnRvTG93ZXJDYXNlKCk7XHJcblxyXG4gICAgICByZXR1cm4gc29ydGVyV2Vla0RheXNbY3VyckRheV0gPiBzb3J0ZXJXZWVrRGF5c1tuZXh0RGF5XSA/IDEgOiAtMTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iXX0=