import { Component, ViewChild } from '@angular/core';
import { poLocaleDefault } from '../po-language/po-language.constant';
import { PoLanguageService } from '../po-language/po-language.service';
import { PoDialogType } from './po-dialog.enum';
import { PoModalComponent } from '../../components/po-modal/po-modal.component';
export const poDialogAlertLiteralsDefault = {
    en: { ok: 'Ok' },
    es: { ok: 'Ok' },
    pt: { ok: 'Ok' },
    ru: { ok: 'Ок' }
};
export const poDialogConfirmLiteralsDefault = {
    en: { cancel: 'Cancel', confirm: 'Confirm' },
    es: { cancel: 'Cancelar', confirm: 'Confirmar' },
    pt: { cancel: 'Cancelar', confirm: 'Confirmar' },
    ru: { cancel: 'отменить', confirm: 'подтвердить' }
};
/**
 * @docsPrivate
 *
 * @description
 *
 * Componente que serve como container do po-dialog.service
 */
export class PoDialogComponent {
    constructor(languageService) {
        // Objeto primary do poModal
        this.primaryAction = { label: 'ok', action: () => { } };
        this.language = languageService.getShortLanguage();
    }
    ngOnDestroy() {
        this.closeSubscription.unsubscribe();
    }
    ngOnInit() {
        this.closeSubscription = this.poModal.onXClosed.subscribe(close => this.close(true));
    }
    // Fecha o poModal
    close(xClosed = false) {
        if (xClosed && this.closeAction) {
            this.closeAction();
        }
        this.poModal.close();
        this.destroy();
    }
    destroy() {
        if (this.componentRef) {
            this.componentRef.destroy();
        }
    }
    // Insere os valores recebidos de this.open para o poModal
    configDialog(primaryLabel, primaryAction, secondaryLabel, secondaryAction, closeAction) {
        this.primaryAction = {
            label: primaryLabel,
            action: () => {
                if (primaryAction) {
                    primaryAction();
                }
                this.close();
            }
        };
        if (secondaryLabel) {
            this.secondaryAction = {
                label: secondaryLabel,
                action: () => {
                    if (secondaryAction) {
                        secondaryAction();
                    }
                    this.close();
                }
            };
        }
        this.closeAction = closeAction;
    }
    // Insere os valores recebidos de po-dialog.service de acordo com o tipo de diálago solicitado
    open(dialogOptions, dialogType, componentRef) {
        this.title = dialogOptions.title;
        this.message = dialogOptions.message;
        this.componentRef = componentRef;
        this.setDialogLiterals(dialogOptions, dialogType);
        switch (dialogType) {
            case PoDialogType.Confirm: {
                this.configDialog(this.literalsConfirm.confirm, dialogOptions.confirm, this.literalsConfirm.cancel, dialogOptions.cancel, dialogOptions.close);
                break;
            }
            case PoDialogType.Alert: {
                this.configDialog(this.literalsAlert.ok, dialogOptions.ok);
                break;
            }
        }
        this.poModal.open();
    }
    setDialogLiterals(dialogOptions, dialogType) {
        const alertLiterals = poDialogAlertLiteralsDefault;
        const confirmLiterals = poDialogConfirmLiteralsDefault;
        const literals = dialogOptions.literals;
        if (dialogType === PoDialogType.Alert) {
            this.literalsAlert = Object.assign(Object.assign(Object.assign({}, alertLiterals[poLocaleDefault]), alertLiterals[this.language]), literals);
        }
        else {
            this.literalsConfirm = Object.assign(Object.assign(Object.assign({}, confirmLiterals[poLocaleDefault]), confirmLiterals[this.language]), literals);
        }
    }
}
PoDialogComponent.decorators = [
    { type: Component, args: [{
                template: "<po-modal [p-title]=\"title\" [p-primary-action]=\"primaryAction\" [p-secondary-action]=\"secondaryAction\">\r\n  <div [innerHtml]=\"message\"></div>\r\n</po-modal>\r\n"
            },] }
];
PoDialogComponent.ctorParameters = () => [
    { type: PoLanguageService }
];
PoDialogComponent.propDecorators = {
    poModal: [{ type: ViewChild, args: [PoModalComponent, { static: true },] }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicG8tZGlhbG9nLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL3VpL3NyYy9saWIvc2VydmljZXMvcG8tZGlhbG9nL3BvLWRpYWxvZy5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBbUMsU0FBUyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBSXRGLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxxQ0FBcUMsQ0FBQztBQUV0RSxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxvQ0FBb0MsQ0FBQztBQUt2RSxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFFaEQsT0FBTyxFQUFFLGdCQUFnQixFQUFFLE1BQU0sOENBQThDLENBQUM7QUFFaEYsTUFBTSxDQUFDLE1BQU0sNEJBQTRCLEdBQUc7SUFDMUMsRUFBRSxFQUF5QixFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUU7SUFDdkMsRUFBRSxFQUF5QixFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUU7SUFDdkMsRUFBRSxFQUF5QixFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUU7SUFDdkMsRUFBRSxFQUF5QixFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUU7Q0FDeEMsQ0FBQztBQUVGLE1BQU0sQ0FBQyxNQUFNLDhCQUE4QixHQUFHO0lBQzVDLEVBQUUsRUFBMkIsRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFFLE9BQU8sRUFBRSxTQUFTLEVBQUU7SUFDckUsRUFBRSxFQUEyQixFQUFFLE1BQU0sRUFBRSxVQUFVLEVBQUUsT0FBTyxFQUFFLFdBQVcsRUFBRTtJQUN6RSxFQUFFLEVBQTJCLEVBQUUsTUFBTSxFQUFFLFVBQVUsRUFBRSxPQUFPLEVBQUUsV0FBVyxFQUFFO0lBQ3pFLEVBQUUsRUFBMkIsRUFBRSxNQUFNLEVBQUUsVUFBVSxFQUFFLE9BQU8sRUFBRSxhQUFhLEVBQUU7Q0FD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QyxFQUFFLENBQUMsQ0FBQztnQkFDbkYsTUFBTTthQUNQO1NBQ0Y7UUFFRCxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksRUFBRSxDQUFDO0lBQ3RCLENBQUM7SUFFTyxpQkFBaUIsQ0FBQyxhQUE0RCxFQUFFLFVBQXdCO1FBQzlHLE1BQU0sYUFBYSxHQUFHLDRCQUE0QixDQUFDO1FBQ25ELE1BQU0sZUFBZSxHQUFHLDhCQUE4QixDQUFDO1FBQ3ZELE1BQU0sUUFBUSxHQUFHLGFBQWEsQ0FBQyxRQUFRLENBQUM7UUFFeEMsSUFBSSxVQUFVLEtBQUssWUFBWSxDQUFDLEtBQUssRUFBRTtZQUNyQyxJQUFJLENBQUMsYUFBYSxpREFBUSxhQUFhLENBQUMsZUFBZSxDQUFDLEdBQUssYUFBYSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsR0FBSyxRQUFRLENBQUUsQ0FBQztTQUMxRzthQUFNO1lBQ0wsSUFBSSxDQUFDLGVBQWUsaURBQ2YsZUFBZSxDQUFDLGVBQWUsQ0FBQyxHQUNoQyxlQUFlLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxHQUM5QixRQUFRLENBQ1osQ0FBQztTQUNIO0lBQ0gsQ0FBQzs7O1lBdklGLFNBQVMsU0FBQztnQkFDVCxvTEFBeUM7YUFDMUM7OztZQWpDUSxpQkFBaUI7OztzQkFvQ3ZCLFNBQVMsU0FBQyxnQkFBZ0IsRUFBRSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIENvbXBvbmVudFJlZiwgT25EZXN0cm95LCBPbkluaXQsIFZpZXdDaGlsZCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5cclxuaW1wb3J0IHsgU3Vic2NyaXB0aW9uIH0gZnJvbSAncnhqcyc7XHJcblxyXG5pbXBvcnQgeyBwb0xvY2FsZURlZmF1bHQgfSBmcm9tICcuLi9wby1sYW5ndWFnZS9wby1sYW5ndWFnZS5jb25zdGFudCc7XHJcblxyXG5pbXBvcnQgeyBQb0xhbmd1YWdlU2VydmljZSB9IGZyb20gJy4uL3BvLWxhbmd1YWdlL3BvLWxhbmd1YWdlLnNlcnZpY2UnO1xyXG5cclxuaW1wb3J0IHsgUG9EaWFsb2dBbGVydExpdGVyYWxzIH0gZnJvbSAnLi9pbnRlcmZhY2VzL3BvLWRpYWxvZy1hbGVydC1saXRlcmFscy5pbnRlcmZhY2UnO1xyXG5pbXBvcnQgeyBQb0RpYWxvZ0FsZXJ0T3B0aW9ucywgUG9EaWFsb2dDb25maXJtT3B0aW9ucyB9IGZyb20gJy4vaW50ZXJmYWNlcy9wby1kaWFsb2cuaW50ZXJmYWNlJztcclxuaW1wb3J0IHsgUG9EaWFsb2dDb25maXJtTGl0ZXJhbHMgfSBmcm9tICcuL2ludGVyZmFjZXMvcG8tZGlhbG9nLWNvbmZpcm0tbGl0ZXJhbHMuaW50ZXJmYWNlJztcclxuaW1wb3J0IHsgUG9EaWFsb2dUeXBlIH0gZnJvbSAnLi9wby1kaWFsb2cuZW51bSc7XHJcbmltcG9ydCB7IFBvTW9kYWxBY3Rpb24gfSBmcm9tICcuLi8uLi9jb21wb25lbnRzL3BvLW1vZGFsL3BvLW1vZGFsLWFjdGlvbi5pbnRlcmZhY2UnO1xyXG5pbXBvcnQgeyBQb01vZGFsQ29tcG9uZW50IH0gZnJvbSAnLi4vLi4vY29tcG9uZW50cy9wby1tb2RhbC9wby1tb2RhbC5jb21wb25lbnQnO1xyXG5cclxuZXhwb3J0IGNvbnN0IHBvRGlhbG9nQWxlcnRMaXRlcmFsc0RlZmF1bHQgPSB7XHJcbiAgZW46IDxQb0RpYWxvZ0FsZXJ0TGl0ZXJhbHM+eyBvazogJ09rJyB9LFxyXG4gIGVzOiA8UG9EaWFsb2dBbGVydExpdGVyYWxzPnsgb2s6ICdPaycgfSxcclxuICBwdDogPFBvRGlhbG9nQWxlcnRMaXRlcmFscz57IG9rOiAnT2snIH0sXHJcbiAgcnU6IDxQb0RpYWxvZ0FsZXJ0TGl0ZXJhbHM+eyBvazogJ9Ce0LonIH1cclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBwb0RpYWxvZ0NvbmZpcm1MaXRlcmFsc0RlZmF1bHQgPSB7XHJcbiAgZW46IDxQb0RpYWxvZ0NvbmZpcm1MaXRlcmFscz57IGNhbmNlbDogJ0NhbmNlbCcsIGNvbmZpcm06ICdDb25maXJtJyB9LFxyXG4gIGVzOiA8UG9EaWFsb2dDb25maXJtTGl0ZXJhbHM+eyBjYW5jZWw6ICdDYW5jZWxhcicsIGNvbmZpcm06ICdDb25maXJtYXInIH0sXHJcbiAgcHQ6IDxQb0RpYWxvZ0NvbmZpcm1MaXRlcmFscz57IGNhbmNlbDogJ0NhbmNlbGFyJywgY29uZmlybTogJ0NvbmZpcm1hcicgfSxcclxuICBydTogPFBvRGlhbG9nQ29uZmlybUxpdGVyYWxzPnsgY2FuY2VsOiAn0L7RgtC80LXQvdC40YLRjCcsIGNvbmZpcm06ICfQv9C+0LTRgtCy0LXRgNC00LjRgtGMJyB9XHJcbn07XHJcblxyXG4vKipcclxuICogQGRvY3NQcml2YXRlXHJcbiAqXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKlxyXG4gKiBDb21wb25lbnRlIHF1ZSBzZXJ2ZSBjb21vIGNvbnRhaW5lciBkbyBwby1kaWFsb2cuc2VydmljZVxyXG4gKi9cclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIHRlbXBsYXRlVXJsOiAnLi9wby1kaWFsb2cuY29tcG9uZW50Lmh0bWwnXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBQb0RpYWxvZ0NvbXBvbmVudCBpbXBsZW1lbnRzIE9uRGVzdHJveSwgT25Jbml0IHtcclxuICAvLyBWaWV3Q2hpbGQgcGFyYSBvIHVzbyBkbyBwby1tb2RhbC5jb21wb25lbnRcclxuICBAVmlld0NoaWxkKFBvTW9kYWxDb21wb25lbnQsIHsgc3RhdGljOiB0cnVlIH0pIHBvTW9kYWw6IFBvTW9kYWxDb21wb25lbnQ7XHJcblxyXG4gIC8vIFRpdGxlIGRvIHBvTW9kYWxcclxuICB0aXRsZTogc3RyaW5nO1xyXG5cclxuICAvLyBNZXNzYWdlIGRvIHBvTW9kYWxcclxuICBtZXNzYWdlOiBzdHJpbmc7XHJcblxyXG4gIC8vIE9iamV0byBwcmltYXJ5IGRvIHBvTW9kYWxcclxuICBwcmltYXJ5QWN0aW9uOiBQb01vZGFsQWN0aW9uID0geyBsYWJlbDogJ29rJywgYWN0aW9uOiAoKSA9PiB7fSB9O1xyXG5cclxuICAvLyBPYmpldG8gc2Vjb25kYXJ5IGRvIHBvTW9kYWxcclxuICBzZWNvbmRhcnlBY3Rpb246IFBvTW9kYWxBY3Rpb247XHJcblxyXG4gIC8vIENhbGxiYWNrIGV4ZWN1dGFkbyBhbyBmZWNoYXIgbyBwb01vZGFsXHJcbiAgY2xvc2VBY3Rpb246IEZ1bmN0aW9uO1xyXG5cclxuICAvLyBMaXRlcmFpcyB1c2FkYXMgbm9zIGJvdMOjbyBkZSBhbGVydGEgZG8gcG9Nb2RhbFxyXG4gIGxpdGVyYWxzQWxlcnQ6IFBvRGlhbG9nQWxlcnRMaXRlcmFscztcclxuXHJcbiAgLy8gTGl0ZXJhaXMgdXNhZGFzIG5vcyBib3TDtWVzIGRlIGNvbmZpcm1hw6fDo28gZG8gcG9Nb2RhbFxyXG4gIGxpdGVyYWxzQ29uZmlybTogUG9EaWFsb2dDb25maXJtTGl0ZXJhbHM7XHJcblxyXG4gIC8vIEF0cmlidXRvIHBhcmEgYXJtYXplbmFyIGEgcmVmZXJlbmNpYSBkbyBjb21wb25lbnRlIGNyaWFkbyB2aWEgc2VydmnDp28uXHJcbiAgcHJpdmF0ZSBjb21wb25lbnRSZWY6IENvbXBvbmVudFJlZjxQb0RpYWxvZ0NvbXBvbmVudD47XHJcbiAgcHJpdmF0ZSBjbG9zZVN1YnNjcmlwdGlvbjogU3Vic2NyaXB0aW9uO1xyXG4gIHByaXZhdGUgbGFuZ3VhZ2U6IHN0cmluZztcclxuXHJcbiAgY29uc3RydWN0b3IobGFuZ3VhZ2VTZXJ2aWNlOiBQb0xhbmd1YWdlU2VydmljZSkge1xyXG4gICAgdGhpcy5sYW5ndWFnZSA9IGxhbmd1YWdlU2VydmljZS5nZXRTaG9ydExhbmd1YWdlKCk7XHJcbiAgfVxyXG5cclxuICBuZ09uRGVzdHJveSgpIHtcclxuICAgIHRoaXMuY2xvc2VTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcclxuICB9XHJcblxyXG4gIG5nT25Jbml0KCkge1xyXG4gICAgdGhpcy5jbG9zZVN1YnNjcmlwdGlvbiA9IHRoaXMucG9Nb2RhbC5vblhDbG9zZWQuc3Vic2NyaWJlKGNsb3NlID0+IHRoaXMuY2xvc2UodHJ1ZSkpO1xyXG4gIH1cclxuXHJcbiAgLy8gRmVjaGEgbyBwb01vZGFsXHJcbiAgY2xvc2UoeENsb3NlZCA9IGZhbHNlKTogdm9pZCB7XHJcbiAgICBpZiAoeENsb3NlZCAmJiB0aGlzLmNsb3NlQWN0aW9uKSB7XHJcbiAgICAgIHRoaXMuY2xvc2VBY3Rpb24oKTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLnBvTW9kYWwuY2xvc2UoKTtcclxuICAgIHRoaXMuZGVzdHJveSgpO1xyXG4gIH1cclxuXHJcbiAgZGVzdHJveSgpIHtcclxuICAgIGlmICh0aGlzLmNvbXBvbmVudFJlZikge1xyXG4gICAgICB0aGlzLmNvbXBvbmVudFJlZi5kZXN0cm95KCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBJbnNlcmUgb3MgdmFsb3JlcyByZWNlYmlkb3MgZGUgdGhpcy5vcGVuIHBhcmEgbyBwb01vZGFsXHJcbiAgY29uZmlnRGlhbG9nKHByaW1hcnlMYWJlbD8sIHByaW1hcnlBY3Rpb24/LCBzZWNvbmRhcnlMYWJlbD8sIHNlY29uZGFyeUFjdGlvbj8sIGNsb3NlQWN0aW9uPykge1xyXG4gICAgdGhpcy5wcmltYXJ5QWN0aW9uID0ge1xyXG4gICAgICBsYWJlbDogcHJpbWFyeUxhYmVsLFxyXG4gICAgICBhY3Rpb246ICgpID0+IHtcclxuICAgICAgICBpZiAocHJpbWFyeUFjdGlvbikge1xyXG4gICAgICAgICAgcHJpbWFyeUFjdGlvbigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgaWYgKHNlY29uZGFyeUxhYmVsKSB7XHJcbiAgICAgIHRoaXMuc2Vjb25kYXJ5QWN0aW9uID0ge1xyXG4gICAgICAgIGxhYmVsOiBzZWNvbmRhcnlMYWJlbCxcclxuICAgICAgICBhY3Rpb246ICgpID0+IHtcclxuICAgICAgICAgIGlmIChzZWNvbmRhcnlBY3Rpb24pIHtcclxuICAgICAgICAgICAgc2Vjb25kYXJ5QWN0aW9uKCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuY2xvc2VBY3Rpb24gPSBjbG9zZUFjdGlvbjtcclxuICB9XHJcblxyXG4gIC8vIEluc2VyZSBvcyB2YWxvcmVzIHJlY2ViaWRvcyBkZSBwby1kaWFsb2cuc2VydmljZSBkZSBhY29yZG8gY29tIG8gdGlwbyBkZSBkacOhbGFnbyBzb2xpY2l0YWRvXHJcbiAgb3BlbihcclxuICAgIGRpYWxvZ09wdGlvbnM6IFBvRGlhbG9nQ29uZmlybU9wdGlvbnMgfCBQb0RpYWxvZ0FsZXJ0T3B0aW9ucyxcclxuICAgIGRpYWxvZ1R5cGU6IFBvRGlhbG9nVHlwZSxcclxuICAgIGNvbXBvbmVudFJlZj86IENvbXBvbmVudFJlZjxQb0RpYWxvZ0NvbXBvbmVudD5cclxuICApOiB2b2lkIHtcclxuICAgIHRoaXMudGl0bGUgPSBkaWFsb2dPcHRpb25zLnRpdGxlO1xyXG4gICAgdGhpcy5tZXNzYWdlID0gZGlhbG9nT3B0aW9ucy5tZXNzYWdlO1xyXG5cclxuICAgIHRoaXMuY29tcG9uZW50UmVmID0gY29tcG9uZW50UmVmO1xyXG5cclxuICAgIHRoaXMuc2V0RGlhbG9nTGl0ZXJhbHMoZGlhbG9nT3B0aW9ucywgZGlhbG9nVHlwZSk7XHJcblxyXG4gICAgc3dpdGNoIChkaWFsb2dUeXBlKSB7XHJcbiAgICAgIGNhc2UgUG9EaWFsb2dUeXBlLkNvbmZpcm06IHtcclxuICAgICAgICB0aGlzLmNvbmZpZ0RpYWxvZyhcclxuICAgICAgICAgIHRoaXMubGl0ZXJhbHNDb25maXJtLmNvbmZpcm0sXHJcbiAgICAgICAgICAoPFBvRGlhbG9nQ29uZmlybU9wdGlvbnM+ZGlhbG9nT3B0aW9ucykuY29uZmlybSxcclxuICAgICAgICAgIHRoaXMubGl0ZXJhbHNDb25maXJtLmNhbmNlbCxcclxuICAgICAgICAgICg8UG9EaWFsb2dDb25maXJtT3B0aW9ucz5kaWFsb2dPcHRpb25zKS5jYW5jZWwsXHJcbiAgICAgICAgICAoPFBvRGlhbG9nQ29uZmlybU9wdGlvbnM+ZGlhbG9nT3B0aW9ucykuY2xvc2VcclxuICAgICAgICApO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICAgIGNhc2UgUG9EaWFsb2dUeXBlLkFsZXJ0OiB7XHJcbiAgICAgICAgdGhpcy5jb25maWdEaWFsb2codGhpcy5saXRlcmFsc0FsZXJ0Lm9rLCAoPFBvRGlhbG9nQWxlcnRPcHRpb25zPmRpYWxvZ09wdGlvbnMpLm9rKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHRoaXMucG9Nb2RhbC5vcGVuKCk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHNldERpYWxvZ0xpdGVyYWxzKGRpYWxvZ09wdGlvbnM6IFBvRGlhbG9nQ29uZmlybU9wdGlvbnMgfCBQb0RpYWxvZ0FsZXJ0T3B0aW9ucywgZGlhbG9nVHlwZTogUG9EaWFsb2dUeXBlKSB7XHJcbiAgICBjb25zdCBhbGVydExpdGVyYWxzID0gcG9EaWFsb2dBbGVydExpdGVyYWxzRGVmYXVsdDtcclxuICAgIGNvbnN0IGNvbmZpcm1MaXRlcmFscyA9IHBvRGlhbG9nQ29uZmlybUxpdGVyYWxzRGVmYXVsdDtcclxuICAgIGNvbnN0IGxpdGVyYWxzID0gZGlhbG9nT3B0aW9ucy5saXRlcmFscztcclxuXHJcbiAgICBpZiAoZGlhbG9nVHlwZSA9PT0gUG9EaWFsb2dUeXBlLkFsZXJ0KSB7XHJcbiAgICAgIHRoaXMubGl0ZXJhbHNBbGVydCA9IHsgLi4uYWxlcnRMaXRlcmFsc1twb0xvY2FsZURlZmF1bHRdLCAuLi5hbGVydExpdGVyYWxzW3RoaXMubGFuZ3VhZ2VdLCAuLi5saXRlcmFscyB9O1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5saXRlcmFsc0NvbmZpcm0gPSB7XHJcbiAgICAgICAgLi4uY29uZmlybUxpdGVyYWxzW3BvTG9jYWxlRGVmYXVsdF0sXHJcbiAgICAgICAgLi4uY29uZmlybUxpdGVyYWxzW3RoaXMubGFuZ3VhZ2VdLFxyXG4gICAgICAgIC4uLmxpdGVyYWxzXHJcbiAgICAgIH07XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiJdfQ==